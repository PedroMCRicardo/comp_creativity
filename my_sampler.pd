#N canvas 0 23 1280 751 10;
#X obj 261 699 dac~;
#X obj 260 664 *~;
#X obj 432 232 vsl 15 128 0 1 0 0 empty empty volume 0 -9 0 10 -204786
-1 -1 3800 1;
#X floatatom 70 379 5 0 0 0 - - -, f 5;
#X floatatom 70 426 5 0 0 0 - - -, f 5;
#X obj 70 402 expr (60/$f1)*1000;
#X obj 38 446 metro;
#X obj 118 308 tgl 15 0 empty empty on/off 17 7 0 10 -262144 -1 -1
0 1;
#X obj 121 279 hsl 128 15 0 200 0 0 empty empty metro -2 -8 0 10 -262144
-1 -1 6350 1;
#X msg -283 326 512;
#X obj -283 354 s window-size;
#X obj 589 237 tgl 15 0 empty empty locker 0 -6 0 8 -262144 -1 -1 1
1;
#X obj 627 247 s lock;
#X obj 117 377 s location;
#X obj -268 597 bng 15 250 50 0 empty empty empty 0 -6 0 8 -262144
-1 -1;
#X obj -268 617 s rewind;
#X obj 38 504 s auto;
#N canvas 0 23 1280 751 fft-analysis 0;
#X obj 503 1138 *~;
#X obj 445 1138 *~;
#X obj 452 1172 -~;
#X obj 796 1132 *~;
#X obj 756 1133 *~;
#X obj 759 1165 +~;
#X obj 784 556 *~;
#X obj 753 603 *~;
#X obj 455 566 *~;
#X obj 391 565 *~;
#X obj 400 667 +~;
#X obj 615 904 *~;
#X obj 577 1428 *~;
#X obj 944 949 rfft~;
#X obj 766 394 rfft~;
#X obj 576 1278 rifft~;
#X obj 577 1461 outlet~;
#X obj 558 904 *~;
#X obj 589 935 +~;
#X obj 762 674 -~;
#X obj 523 1022 *~;
#X obj 597 1019 *~;
#X obj 598 1369 r window-size;
#X obj 1310 36 r window-size;
#X obj 1310 85 block~;
#X obj 404 849 +~ 1e-15;
#X obj 577 1344 *~;
#X obj 598 1402 expr 2/(3*$f1);
#X obj 1475 4 loadbang;
#X msg 1475 30 \; pd dsp 1 \; window-size 2048 \; transpo 0 \; rewind
bang;
#X msg 1310 60 set \$1 4;
#X obj 589 959 q8_rsqrt~;
#N canvas 331 23 949 751 read-windows 0;
#X obj 89 1203 *~;
#X obj 796 430 r window-size;
#X obj 130 478 f;
#X obj 102 91 r window-size;
#X obj 102 167 /;
#X obj 389 1193 *~;
#X obj 114 386 bang~;
#X obj 87 941 line~;
#X obj 102 196 * 1000;
#X obj 322 329 r speed;
#X obj 166 386 r location;
#X obj 217 450 +;
#X obj 322 382 *;
#X obj 195 553 / 1000;
#X obj 174 576 *;
#X obj 110 1061 / 4;
#X obj 322 352 * 0.01;
#X floatatom 797 623 7 0 0 0 - - -, f 7;
#X obj 797 504 *;
#X obj 958 323 r transpo;
#X obj 958 347 * 0.01;
#X obj 958 372 + 69;
#X obj 958 397 mtof;
#X obj 958 423 / 440;
#X obj 958 449 t b f;
#X obj 90 1229 outlet~;
#X obj 389 1228 outlet~;
#X obj 1125 865 r location;
#X msg 1125 888 0;
#X obj 1125 911 s speed;
#X obj 1125 943 r speed;
#X msg 1125 967 set \$1;
#X obj 1125 992 s speed-set;
#X obj 1125 1024 r transpo;
#X msg 1125 1050 set \$1;
#X obj 1125 1075 s transpo-set;
#X obj 973 866 r location;
#X msg 991 1050 set \$1;
#X obj 973 912 t b f;
#X obj 991 1029 f;
#X obj 919 943 int;
#X obj 919 975 sel 0;
#X msg 978 946 1;
#X msg 978 969 0;
#X obj 919 1000 del 300;
#X obj 991 1074 s location-set;
#X obj 89 1132 tabread4~ \$0-sample;
#X obj 388 1135 tabread4~ \$0-sample;
#X obj 195 529 r \$0-insamprate;
#X obj 775 864 r rewind;
#X msg 775 1022 \; location \$1;
#X floatatom 111 220 5 0 0 0 - - -, f 5;
#X obj 102 115 t f b;
#X obj 139 141 samplerate~;
#X obj 102 243 / 4;
#X obj 217 475 s see-loc;
#X obj 982 888 r see-loc;
#X obj 196 635 / 2;
#X obj 175 705 -;
#X obj 89 1094 -~;
#X obj 775 998 * -0.5;
#X obj 775 944 /;
#X obj 775 969 * 1000;
#X obj 775 920 t f b;
#X obj 815 944 samplerate~;
#X obj 775 897 f;
#X msg 1243 963 \; rewind bang \; speed \$1;
#X obj 1243 936 r auto;
#X obj 1242 864 r no-detune;
#X obj 87 854 f;
#X obj 87 884 pack;
#X obj 87 825 b;
#X msg 87 911 0 \, \$1 \$2;
#X msg 1242 886 \; transpo 0;
#X text 225 91 512;
#X text 233 143 44100;
#X text 165 208 Tamanho de cada janela;
#X text 159 245 (t2-t1) diferença de tempo entre o inicio da janela
1 e da janela 2 (overlap = 3/4 * Tamanha de cada janela);
#X text 392 328 velocidade (speed) a a que as janelas/sample são lidas
;
#X text 815 819 main window controls;
#X text 335 530 sample rate do sample escolhido pelo user - S1;
#X text 309 448 Localização da janela incial "front window" - L1
(dependente do speed);
#X text 921 301 recebido main window;
#X text 112 363 recebido main window;
#X text 808 411 512;
#X text 769 504 K1;
#X text 867 620 novo windows size tendo em conta a transp;
#X text 208 706 localizaçao J2 = recuar 1/2 *J1;
#X text 847 517 A transposição é conseguida fazendo un strech da
windows (J) size. transp (aumenta ) => K1(diminui);
#X text 216 586 localizaçao J1 \, tendo em conta L1 e S1;
#X text 127 1093 localização J4 = recuar 1/4 J1;
#X text 818 769 NOT IMPORTANT;
#X text 689 786 -----------------------------------------------------------
;
#X text 315 484 L1 - ponto medio da "front window;
#X text 43 6 comment;
#X text 169 1259 Envia 2 windows (snapchot) separadas em (t2-t1 = 1/4)
;
#X text 148 1230 J4;
#X text 450 1227 J1;
#X text 151 219 comment;
#X text 1169 801 comment;
#X obj 410 1162 tabreceive~ \$0-hann;
#X connect 0 0 25 0;
#X connect 1 0 18 0;
#X connect 2 0 11 0;
#X connect 2 0 14 0;
#X connect 3 0 52 0;
#X connect 4 0 8 0;
#X connect 5 0 26 0;
#X connect 6 0 2 0;
#X connect 7 0 59 0;
#X connect 7 0 47 0;
#X connect 8 0 51 0;
#X connect 8 0 54 0;
#X connect 9 0 16 0;
#X connect 10 0 2 1;
#X connect 11 0 2 1;
#X connect 11 0 55 0;
#X connect 12 0 11 1;
#X connect 13 0 14 1;
#X connect 14 0 58 0;
#X connect 15 0 59 1;
#X connect 16 0 12 0;
#X connect 17 0 15 0;
#X connect 17 0 57 0;
#X connect 17 0 65 1;
#X connect 17 0 69 1;
#X connect 18 0 17 0;
#X connect 19 0 20 0;
#X connect 20 0 21 0;
#X connect 21 0 22 0;
#X connect 22 0 23 0;
#X connect 23 0 24 0;
#X connect 24 0 18 0;
#X connect 24 1 18 1;
#X connect 27 0 28 0;
#X connect 28 0 29 0;
#X connect 30 0 31 0;
#X connect 31 0 32 0;
#X connect 33 0 34 0;
#X connect 34 0 35 0;
#X connect 36 0 38 0;
#X connect 37 0 45 0;
#X connect 38 0 40 0;
#X connect 38 1 39 1;
#X connect 39 0 37 0;
#X connect 40 0 41 0;
#X connect 41 0 42 0;
#X connect 41 0 44 0;
#X connect 42 0 40 1;
#X connect 43 0 40 1;
#X connect 44 0 43 0;
#X connect 44 0 39 0;
#X connect 46 0 0 0;
#X connect 47 0 5 0;
#X connect 48 0 13 0;
#X connect 49 0 65 0;
#X connect 52 0 4 0;
#X connect 52 1 53 0;
#X connect 53 0 4 1;
#X connect 54 0 12 1;
#X connect 54 0 70 1;
#X connect 56 0 38 0;
#X connect 57 0 58 1;
#X connect 58 0 71 0;
#X connect 58 0 46 1;
#X connect 58 0 47 1;
#X connect 59 0 46 0;
#X connect 60 0 50 0;
#X connect 61 0 62 0;
#X connect 62 0 60 0;
#X connect 63 0 61 0;
#X connect 63 1 64 0;
#X connect 64 0 61 1;
#X connect 65 0 63 0;
#X connect 67 0 66 0;
#X connect 68 0 73 0;
#X connect 69 0 70 0;
#X connect 70 0 72 0;
#X connect 71 0 69 0;
#X connect 72 0 7 0;
#X connect 100 0 5 1;
#X connect 100 0 0 1;
#X restore 823 297 pd read-windows;
#X obj 766 1193 tabsend~ prev-imag;
#X obj 310 1226 tabsend~ prev-real;
#X obj 364 8 tabreceive~ prev-real;
#X obj 593 5 tabreceive~ prev-imag;
#X obj 505 60 *~;
#X obj 383 63 *~;
#X obj 456 102 +~;
#X obj 456 159 q8_rsqrt~;
#X obj 456 130 +~ 1e-20;
#X obj 456 361 *~;
#X obj 392 363 *~;
#X obj 607 678 r lock;
#X obj 434 704 lrshift~ 1;
#X obj 429 728 lrshift~ -1;
#X obj 777 705 lrshift~ 1;
#X obj 761 732 lrshift~ -1;
#X obj 755 794 *~;
#X obj 404 825 +~;
#X obj 728 821 +~;
#X text 1271 1 'set' message to block;
#X text 1274 18 allows variable size;
#X text 999 993 z = a + bj;
#X text 534 129 prevenção overflows;
#X text 316 6 a';
#X text 861 42 **(') - previous;
#X text 774 6 b' (*j);
#X text 323 62 |a'|;
#X text 534 60 |b'|;
#X text 570 101 = |a'|+|b'|;
#X text 548 161 recall previous output amplitude = M';
#X text 285 565 M' * a' * a1;
#X text 496 362 M' * b' (*j);
#X text 767 324 J1 = a1 * (b1*j);
#X text 946 322 J4 = a4 * (b4*j);
#X text 489 568 M' * b' (*j) * b1 (*j);
#X text 295 359 M' * a';
#X text 819 558 M' * a' * b4(*j);
#X text 790 606 M' * b' (*j) * a1;
#X text 770 349 back window;
#X text 978 346 front window;
#X text 35 457 Take FT of the window in back. Multiply its conjugate
by the normalized previous output. The result has the magnitude of
the input sound and phase (previous output phase) minus (back window
phase).;
#X text 796 673 Resultado: Magnitude: input sound pahse: previous output
phase - back window phase;
#X obj 436 799 *~;
#X text 11 707 If "lock" is on \, encourage neighboring channels to
stay in phase by adding the two neighboring complex amplitudes.;
#X text 681 962 magnitude;
#X text 281 825 complex number;
#X text 599 819 complex number;
#X text 967 555 Muliplicação do conjugado pelo oututup anterior;
#X text 1212 928 Note:;
#X text 1211 944 Rfft:The imaginary part of the input is assumed to
be zero. less computation cost;
#X text 722 1251 magnitude: will be that of the forward window phase:
previous output phase plus the phase difference between the two analysis
windows --;
#X text 899 764 comment;
#X obj 598 1318 tabreceive~ \$0-hann;
#X connect 0 0 2 1;
#X connect 1 0 2 0;
#X connect 2 0 34 0;
#X connect 2 0 15 0;
#X connect 3 0 5 1;
#X connect 4 0 5 0;
#X connect 5 0 33 0;
#X connect 5 0 15 1;
#X connect 6 0 19 1;
#X connect 7 0 19 0;
#X connect 8 0 10 1;
#X connect 9 0 10 0;
#X connect 10 0 46 0;
#X connect 10 0 45 0;
#X connect 10 0 50 0;
#X connect 11 0 18 1;
#X connect 12 0 16 0;
#X connect 13 0 1 1;
#X connect 13 0 3 1;
#X connect 13 1 0 1;
#X connect 13 1 4 1;
#X connect 14 0 9 1;
#X connect 14 0 7 1;
#X connect 14 1 6 1;
#X connect 14 1 8 1;
#X connect 15 0 26 0;
#X connect 17 0 18 0;
#X connect 18 0 31 0;
#X connect 19 0 47 0;
#X connect 19 0 48 0;
#X connect 19 0 51 0;
#X connect 20 0 1 0;
#X connect 20 0 4 0;
#X connect 21 0 0 0;
#X connect 21 0 3 0;
#X connect 22 0 27 0;
#X connect 23 0 30 0;
#X connect 25 0 17 1;
#X connect 25 0 17 0;
#X connect 25 0 20 0;
#X connect 26 0 12 0;
#X connect 27 0 12 1;
#X connect 28 0 29 0;
#X connect 30 0 24 0;
#X connect 31 0 20 1;
#X connect 31 0 21 1;
#X connect 32 0 14 0;
#X connect 32 1 13 0;
#X connect 35 0 38 1;
#X connect 35 0 38 0;
#X connect 35 0 43 0;
#X connect 36 0 37 1;
#X connect 36 0 37 0;
#X connect 36 0 42 0;
#X connect 37 0 39 1;
#X connect 38 0 39 0;
#X connect 39 0 41 0;
#X connect 40 0 42 1;
#X connect 40 0 43 1;
#X connect 41 0 40 0;
#X connect 42 0 8 0;
#X connect 42 0 7 0;
#X connect 43 0 9 0;
#X connect 43 0 6 0;
#X connect 44 0 49 1;
#X connect 44 0 75 1;
#X connect 45 0 75 0;
#X connect 46 0 75 0;
#X connect 47 0 49 0;
#X connect 48 0 49 0;
#X connect 49 0 51 1;
#X connect 50 0 25 0;
#X connect 51 0 11 0;
#X connect 51 0 11 1;
#X connect 51 0 21 0;
#X connect 75 0 50 1;
#X connect 85 0 26 1;
#X restore 258 498 pd fft-analysis;
#N canvas 35 107 565 454 hann-window 0;
#N canvas 0 22 450 300 (subpatch) 0;
#X array \$0-hann 4096 float 0;
#X coords 0 1 4095 0 300 100 1;
#X restore 82 311 graph;
#X obj 378 165 osc~;
#X obj 378 190 *~ -0.5;
#X obj 378 214 +~ 0.5;
#X obj 331 247 tabwrite~ \$0-hann;
#X obj 37 88 r window-size;
#X obj 38 173 /;
#X obj 127 142 samplerate~;
#X obj 38 251 s window-sec;
#X obj 177 204 swap;
#X obj 177 228 /;
#X obj 177 252 s window-hz;
#X obj 49 201 * 1000;
#X obj 49 228 s window-msec;
#X obj 38 115 t f b f;
#X msg 173 92 resize \$1;
#X obj 173 116 s \$0-hann;
#X obj 330 105 r window-hz;
#X msg 382 130 0;
#X obj 330 131 t f b;
#X text 15 8 calculate Hann window table (variable window size) and
constants window-hz (fundamental frequency of analysis) \, window-sec
and window-msec (analysis window size in seconds and msec).;
#X connect 1 0 2 0;
#X connect 2 0 3 0;
#X connect 3 0 4 0;
#X connect 5 0 14 0;
#X connect 6 0 8 0;
#X connect 6 0 12 0;
#X connect 7 0 6 1;
#X connect 7 0 9 1;
#X connect 9 0 10 0;
#X connect 9 1 10 1;
#X connect 10 0 11 0;
#X connect 12 0 13 0;
#X connect 14 0 6 0;
#X connect 14 0 9 0;
#X connect 14 1 7 0;
#X connect 14 2 15 0;
#X connect 15 0 16 0;
#X connect 17 0 19 0;
#X connect 18 0 1 1;
#X connect 19 0 1 0;
#X connect 19 1 4 0;
#X connect 19 1 18 0;
#X restore -408 353 pd hann-window;
#X obj 275 380 s speed;
#X obj 276 233 vsl 15 128 0 200 0 0 empty empty speed 0 -9 0 10 -262144
-1 -1 5000 1;
#X obj 348 399 bng 15 250 50 0 no-detune empty empty 0 -6 0 8 -262144
-1 -1;
#X obj 118 248 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144
-1 -1;
#X msg 38 474 100;
#N canvas 260 23 647 699 phase-tables 0;
#N canvas 0 22 450 300 (subpatch) 0;
#X array prev-imag 4096 float 0;
#X coords 0 1000 4096 -1000 400 300 1;
#X restore 169 326 graph;
#N canvas 0 22 450 300 (subpatch) 0;
#X array prev-real 4096 float 0;
#X coords 0 500 4096 -500 400 300 1;
#X restore 170 17 graph;
#X restore -408 325 pd phase-tables;
#X obj 347 231 vsl 15 128 -500 500 0 0 empty empty transpose 0 -9 0
10 -204786 -1 -1 2300 1;
#N canvas 0 22 450 300 (subpatch) 0;
#X array \$0-sample 213388 float 0;
#X coords 0 1 213387 -1 340 75 1 0 0;
#X restore 119 131 graph;
#X obj -408 22 r read-sample;
#X obj -408 73 unpack s f;
#X obj -408 183 soundfiler;
#X obj -186 109 loadbang;
#X obj -408 99 t s b;
#X obj -352 98 symbol \$0-sample;
#X obj -408 134 pack s s;
#X msg -408 159 read -resize \$1 \$2;
#X obj -353 45 44100;
#X obj -408 46 t a b;
#X obj -398 207 s \$0-samplength;
#X obj -311 73 s \$0-insamprate;
#X obj -408 246 /;
#X obj -408 270 * 1000;
#X obj -408 296 s \$0-samp-msec;
#X obj -370 246 r \$0-insamprate;
#X obj 120 337 hsl 128 15 0 500 0 0 empty empty empty -2 -8 0 10 -262144
-1 -1 11500 1;
#X msg -186 158 \; read-sample ../sound/dii.wav;
#N canvas 6 23 1234 551 chorusing 0;
#X msg -398 182 4096;
#X msg -57 131 4096;
#X obj -557 350 *~;
#X obj -255 322 *~;
#X obj -552 -192 delwrite~ firstV 5000;
#X obj -201 -194 delwrite~ secondV 5000;
#X floatatom -482 202 5 0 0 0 - - -, f 5;
#X floatatom -111 122 5 0 0 0 - - -, f 5;
#X obj -538 322 expr $f1 / 127;
#X obj -232 245 expr $f1 / 127;
#X obj -575 -102 expr $f1 / 127;
#X obj -170 -124 expr $f1 / 127;
#X obj -56 100 expr ($i1 - 64) * 40;
#X obj -453 153 expr ($i1 - 64) * 40;
#X obj -194 -89 *~;
#X obj -618 -71 *~;
#X text -477 -136 FB volume;
#X text -73 -159 FB volume;
#X text -426 97 transpose in cents;
#X text -43 46 transpose in cents;
#X obj -571 41 vd~ firstV 4000;
#X obj -205 11 vd~ secondV 4500;
#X obj -429 1 sig~;
#X obj -427 -27 expr ($i1 / 127) * 40;
#X obj -49 -29 sig~;
#X obj -47 -57 expr ($i1 / 127) * 40;
#X text -329 -53 Del time;
#X text 56 -90 Del time;
#X text -449 289 Voice vol;
#X text -132 214 Voice vol;
#X obj -346 179 loadbang;
#X obj -4 127 loadbang;
#N canvas 304 82 740 484 fft-pitchshifter-sub 0;
#N canvas 664 23 616 699 fft-analysis 0;
#X obj 51 477 *~;
#X obj 18 477 *~;
#X obj 18 499 -~;
#X obj 167 475 *~;
#X obj 136 475 *~;
#X obj 136 497 +~;
#X obj 109 193 *~;
#X obj 78 193 *~;
#X obj 50 193 *~;
#X obj 19 193 *~;
#X obj 19 218 +~;
#X obj 127 379 *~;
#X obj 20 622 *~;
#X obj 236 175 rfft~;
#X obj 108 161 rfft~;
#X obj 19 564 rifft~;
#X obj 21 646 outlet~;
#X obj 97 379 *~;
#X obj 97 401 +~;
#X obj 124 218 -~;
#X obj 18 431 *~;
#X obj 51 432 *~;
#X obj 21 728 block~;
#X obj 19 349 +~ 1e-15;
#X obj 19 598 *~;
#X obj 52 598 tabreceive~ \$0-hann;
#X obj 127 643 expr 2/(3*$f1);
#X obj 415 626 loadbang;
#X msg 21 703 set \$1 4;
#X obj 97 425 q8_rsqrt~;
#X obj 121 69 *~;
#X obj 89 69 *~;
#X obj 89 91 +~;
#X obj 159 94 q8_rsqrt~;
#X obj 159 71 +~ 1e-20;
#X obj 73 119 *~;
#X obj 19 118 *~;
#X obj 29 245 lrshift~ 1;
#X obj 24 269 lrshift~ -1;
#X obj 141 245 lrshift~ 1;
#X obj 133 269 lrshift~ -1;
#X obj 35 300 *~;
#X obj 159 312 *~;
#X obj 19 325 +~;
#X obj 125 331 +~;
#N canvas 139 80 520 694 read-windows 0;
#X obj 18 358 line~;
#X obj 16 523 outlet~;
#X obj 125 531 outlet~;
#X text 220 313 "back" window 1/4 cycle behind "front" one;
#X obj 16 441 vd~ \$0-input;
#X obj 123 443 vd~ \$0-input;
#X obj 18 266 pack f f;
#X obj 31 143 t b f;
#X obj 31 184 -;
#X obj 90 145 *;
#X obj 90 114 - 1;
#X obj 90 57 mtof;
#X obj 90 77 / 440;
#X obj 90 38 + 69;
#X obj 353 123 samplerate~;
#X obj 328 102 t f b;
#X obj 328 141 /;
#X obj 328 163 * 1000;
#X obj 90 16 * 0.01;
#X text 376 163 window size (ms);
#X obj 18 207 f;
#X obj 164 468 tabreceive~ \$0-hann;
#X obj 16 492 *~;
#X obj 124 503 *~;
#X obj 18 75 bang~;
#X obj 31 164 100;
#X obj 197 286 *;
#X obj 206 263 t b f;
#X text 235 288 stretched window size (ms);
#X obj 90 -6 r \$0-transpo;
#X obj 328 81 r \$0-window-size;
#X obj 220 210 / 4;
#X text 252 207 computation time for an overlap of 4;
#X obj 18 230 / 4;
#X obj 71 229 / 4;
#X obj 17 393 +~;
#X obj 193 310 / 4;
#X obj 135 369 / 4;
#X text 47 395 '+' since a bigger value in vd~ means 'earlier'.;
#X text 114 110 subtract speed of read-out \, when;
#X text 114 122 delay-time is static;
#X text 134 37 convert cents of halftones to read-out speed;
#X text 41 229 *);
#X text 93 229 *);
#X text 162 367 *);
#X text 67 336 *);
#X obj 18 287 t l b;
#X obj 43 309 100;
#X obj 43 333 / 4;
#X text 57 165 initial delay (ms);
#X text 71 307 initial delay (ms);
#X text 21 556 *);
#X text 24 572 it seems that if a time is specified in ms instead of
samples \, the value has to be divided by the overlap factor (4 in
this case) in order for the vd~ to read out the desired amount of samples.
i'm still unsure what the reason for this might be.;
#X connect 0 0 5 0;
#X connect 0 0 35 0;
#X connect 4 0 22 0;
#X connect 5 0 23 0;
#X connect 6 0 46 0;
#X connect 7 0 25 0;
#X connect 7 1 8 1;
#X connect 8 0 20 1;
#X connect 9 0 7 0;
#X connect 10 0 9 0;
#X connect 11 0 12 0;
#X connect 12 0 10 0;
#X connect 12 0 26 0;
#X connect 13 0 11 0;
#X connect 14 0 16 1;
#X connect 15 0 16 0;
#X connect 15 1 14 0;
#X connect 16 0 17 0;
#X connect 17 0 9 1;
#X connect 17 0 27 0;
#X connect 17 0 31 0;
#X connect 18 0 13 0;
#X connect 20 0 33 0;
#X connect 21 0 23 1;
#X connect 21 0 22 1;
#X connect 22 0 1 0;
#X connect 23 0 2 0;
#X connect 24 0 20 0;
#X connect 25 0 8 0;
#X connect 26 0 36 0;
#X connect 27 0 26 0;
#X connect 27 1 26 1;
#X connect 29 0 18 0;
#X connect 30 0 15 0;
#X connect 31 0 34 0;
#X connect 33 0 6 0;
#X connect 34 0 6 1;
#X connect 35 0 4 0;
#X connect 36 0 37 0;
#X connect 37 0 35 1;
#X connect 46 0 0 0;
#X connect 46 1 47 0;
#X connect 47 0 48 0;
#X connect 48 0 0 0;
#X restore 379 86 pd read-windows;
#X obj 137 543 tabsend~ \$0-prev-imag;
#X obj 136 567 tabsend~ \$0-prev-real;
#X obj 73 29 tabreceive~ \$0-prev-imag;
#X obj 20 8 tabreceive~ \$0-prev-real;
#X obj 415 648 \$0;
#X obj 21 679 r \$0-window-size;
#X obj 127 622 r \$0-window-size;
#X obj 187 290 r \$0-lock;
#X msg 415 669 \; \$1-window-size 2048 \; \$1-transpo 0 \; \$1-lock
1 \;;
#X connect 0 0 2 1;
#X connect 1 0 2 0;
#X connect 2 0 15 0;
#X connect 2 0 47 0;
#X connect 3 0 5 1;
#X connect 4 0 5 0;
#X connect 5 0 15 1;
#X connect 5 0 46 0;
#X connect 6 0 19 1;
#X connect 7 0 19 0;
#X connect 8 0 10 1;
#X connect 9 0 10 0;
#X connect 10 0 38 0;
#X connect 10 0 37 0;
#X connect 10 0 43 0;
#X connect 11 0 18 1;
#X connect 12 0 16 0;
#X connect 13 0 1 1;
#X connect 13 0 3 1;
#X connect 13 1 0 1;
#X connect 13 1 4 1;
#X connect 14 0 9 1;
#X connect 14 0 7 1;
#X connect 14 1 6 1;
#X connect 14 1 8 1;
#X connect 15 0 24 0;
#X connect 17 0 18 0;
#X connect 18 0 29 0;
#X connect 19 0 39 0;
#X connect 19 0 40 0;
#X connect 19 0 44 0;
#X connect 20 0 1 0;
#X connect 20 0 4 0;
#X connect 21 0 0 0;
#X connect 21 0 3 0;
#X connect 23 0 17 1;
#X connect 23 0 17 0;
#X connect 23 0 20 0;
#X connect 24 0 12 0;
#X connect 25 0 24 1;
#X connect 26 0 12 1;
#X connect 27 0 50 0;
#X connect 28 0 22 0;
#X connect 29 0 20 1;
#X connect 29 0 21 1;
#X connect 30 0 32 1;
#X connect 31 0 32 0;
#X connect 32 0 34 0;
#X connect 33 0 35 1;
#X connect 33 0 36 1;
#X connect 34 0 33 0;
#X connect 35 0 8 0;
#X connect 35 0 7 0;
#X connect 36 0 9 0;
#X connect 36 0 6 0;
#X connect 37 0 41 0;
#X connect 38 0 41 0;
#X connect 39 0 42 0;
#X connect 40 0 42 0;
#X connect 41 0 43 1;
#X connect 42 0 44 1;
#X connect 43 0 23 0;
#X connect 44 0 11 0;
#X connect 44 0 11 1;
#X connect 44 0 21 0;
#X connect 45 0 14 0;
#X connect 45 1 13 0;
#X connect 48 0 30 1;
#X connect 48 0 30 0;
#X connect 48 0 35 0;
#X connect 49 0 31 1;
#X connect 49 0 31 0;
#X connect 49 0 36 0;
#X connect 50 0 54 0;
#X connect 51 0 28 0;
#X connect 52 0 26 0;
#X connect 53 0 41 1;
#X connect 53 0 42 1;
#X restore 294 501 pd fft-analysis;
#N canvas 260 50 667 789 phase-tables 0;
#N canvas 0 50 450 300 (subpatch) 0;
#X array \$0-prev-imag 4096 float 0;
#X coords 0 1000 4096 -1000 400 300 1;
#X restore 169 326 graph;
#N canvas 0 50 450 300 (subpatch) 0;
#X array \$0-prev-real 4096 float 0;
#X coords 0 500 4096 -500 400 300 1;
#X restore 170 17 graph;
#X restore 694 628 pd phase-tables;
#N canvas 0 110 400 363 hann-window 0;
#N canvas 0 50 450 300 (subpatch) 0;
#X array \$0-hann 4096 float 0;
#X coords 0 1 4095 0 300 100 1;
#X restore 36 253 graph;
#X obj 288 130 osc~;
#X obj 288 155 *~ -0.5;
#X obj 288 179 +~ 0.5;
#X obj 241 212 tabwrite~ \$0-hann;
#X obj 26 118 samplerate~;
#X obj 26 142 /;
#X msg 161 71 resize \$1;
#X obj 161 95 s \$0-hann;
#X msg 292 95 0;
#X obj 240 96 t f b;
#X obj 26 67 r \$0-window-size;
#X obj 26 166 s \$0-window-hz;
#X obj 240 70 r \$0-window-hz;
#X obj 26 94 t b f f;
#X text 22 8 calculate Hann window table (variable window size) and
constants window-hz (fundamental frequency of analysis).;
#X connect 1 0 2 0;
#X connect 2 0 3 0;
#X connect 3 0 4 0;
#X connect 5 0 6 0;
#X connect 6 0 12 0;
#X connect 7 0 8 0;
#X connect 9 0 1 1;
#X connect 10 0 1 0;
#X connect 10 1 4 0;
#X connect 10 1 9 0;
#X connect 11 0 14 0;
#X connect 13 0 10 0;
#X connect 14 0 5 0;
#X connect 14 1 6 1;
#X connect 14 2 7 0;
#X restore 694 657 pd hann-window;
#X obj 294 472 delwrite~ \$0-input 1000;
#X obj 294 400 inlet~;
#X obj 296 599 outlet~;
#X obj 626 512 s \$0-transpo;
#X obj 375 400 inlet;
#X obj 657 466 s \$0-window-size;
#X obj 689 381 inlet;
#X obj 555 463 f;
#X obj 606 433 t b f;
#X connect 0 0 5 0;
#X connect 4 0 3 0;
#X connect 7 0 10 0;
#X connect 9 0 11 0;
#X connect 10 0 6 0;
#X connect 11 0 10 0;
#X connect 11 1 8 0;
#X restore -589 230 pd fft-pitchshifter-sub;
#N canvas 329 112 450 300 fft-pitchshifter-sub 0;
#N canvas 948 104 616 776 fft-analysis 0;
#X obj 51 477 *~;
#X obj 18 477 *~;
#X obj 18 499 -~;
#X obj 167 475 *~;
#X obj 136 475 *~;
#X obj 136 497 +~;
#X obj 109 193 *~;
#X obj 78 193 *~;
#X obj 50 193 *~;
#X obj 19 193 *~;
#X obj 19 218 +~;
#X obj 127 379 *~;
#X obj 20 622 *~;
#X obj 236 175 rfft~;
#X obj 108 161 rfft~;
#X obj 19 564 rifft~;
#X obj 21 646 outlet~;
#X obj 97 379 *~;
#X obj 97 401 +~;
#X obj 124 218 -~;
#X obj 18 431 *~;
#X obj 51 432 *~;
#X obj 21 728 block~;
#X obj 19 349 +~ 1e-15;
#X obj 19 598 *~;
#X obj 52 598 tabreceive~ \$0-hann;
#X obj 127 643 expr 2/(3*$f1);
#X obj 415 626 loadbang;
#X msg 21 703 set \$1 4;
#X obj 97 425 q8_rsqrt~;
#X obj 121 69 *~;
#X obj 89 69 *~;
#X obj 89 91 +~;
#X obj 159 94 q8_rsqrt~;
#X obj 159 71 +~ 1e-20;
#X obj 73 119 *~;
#X obj 19 118 *~;
#X obj 29 245 lrshift~ 1;
#X obj 24 269 lrshift~ -1;
#X obj 141 245 lrshift~ 1;
#X obj 133 269 lrshift~ -1;
#X obj 35 300 *~;
#X obj 159 312 *~;
#X obj 19 325 +~;
#X obj 125 331 +~;
#N canvas 139 105 520 694 read-windows 0;
#X obj 18 358 line~;
#X obj 16 523 outlet~;
#X obj 125 531 outlet~;
#X text 220 313 "back" window 1/4 cycle behind "front" one;
#X obj 16 441 vd~ \$0-input;
#X obj 123 443 vd~ \$0-input;
#X obj 18 266 pack f f;
#X obj 31 143 t b f;
#X obj 31 184 -;
#X obj 90 145 *;
#X obj 90 114 - 1;
#X obj 90 57 mtof;
#X obj 90 77 / 440;
#X obj 90 38 + 69;
#X obj 353 123 samplerate~;
#X obj 328 102 t f b;
#X obj 328 141 /;
#X obj 328 163 * 1000;
#X obj 90 16 * 0.01;
#X text 376 163 window size (ms);
#X obj 18 207 f;
#X obj 164 468 tabreceive~ \$0-hann;
#X obj 16 492 *~;
#X obj 124 503 *~;
#X obj 18 75 bang~;
#X obj 31 164 100;
#X obj 197 286 *;
#X obj 206 263 t b f;
#X text 235 288 stretched window size (ms);
#X obj 90 -6 r \$0-transpo;
#X obj 328 81 r \$0-window-size;
#X obj 220 210 / 4;
#X text 252 207 computation time for an overlap of 4;
#X obj 18 230 / 4;
#X obj 71 229 / 4;
#X obj 17 393 +~;
#X obj 193 310 / 4;
#X obj 135 369 / 4;
#X text 47 395 '+' since a bigger value in vd~ means 'earlier'.;
#X text 114 110 subtract speed of read-out \, when;
#X text 114 122 delay-time is static;
#X text 134 37 convert cents of halftones to read-out speed;
#X text 41 229 *);
#X text 93 229 *);
#X text 162 367 *);
#X text 67 336 *);
#X obj 18 287 t l b;
#X obj 43 309 100;
#X obj 43 333 / 4;
#X text 57 165 initial delay (ms);
#X text 71 307 initial delay (ms);
#X text 21 556 *);
#X text 24 572 it seems that if a time is specified in ms instead of
samples \, the value has to be divided by the overlap factor (4 in
this case) in order for the vd~ to read out the desired amount of samples.
i'm still unsure what the reason for this might be.;
#X connect 0 0 5 0;
#X connect 0 0 35 0;
#X connect 4 0 22 0;
#X connect 5 0 23 0;
#X connect 6 0 46 0;
#X connect 7 0 25 0;
#X connect 7 1 8 1;
#X connect 8 0 20 1;
#X connect 9 0 7 0;
#X connect 10 0 9 0;
#X connect 11 0 12 0;
#X connect 12 0 10 0;
#X connect 12 0 26 0;
#X connect 13 0 11 0;
#X connect 14 0 16 1;
#X connect 15 0 16 0;
#X connect 15 1 14 0;
#X connect 16 0 17 0;
#X connect 17 0 9 1;
#X connect 17 0 27 0;
#X connect 17 0 31 0;
#X connect 18 0 13 0;
#X connect 20 0 33 0;
#X connect 21 0 23 1;
#X connect 21 0 22 1;
#X connect 22 0 1 0;
#X connect 23 0 2 0;
#X connect 24 0 20 0;
#X connect 25 0 8 0;
#X connect 26 0 36 0;
#X connect 27 0 26 0;
#X connect 27 1 26 1;
#X connect 29 0 18 0;
#X connect 30 0 15 0;
#X connect 31 0 34 0;
#X connect 33 0 6 0;
#X connect 34 0 6 1;
#X connect 35 0 4 0;
#X connect 36 0 37 0;
#X connect 37 0 35 1;
#X connect 46 0 0 0;
#X connect 46 1 47 0;
#X connect 47 0 48 0;
#X connect 48 0 0 0;
#X restore 379 86 pd read-windows;
#X obj 137 543 tabsend~ \$0-prev-imag;
#X obj 136 567 tabsend~ \$0-prev-real;
#X obj 73 29 tabreceive~ \$0-prev-imag;
#X obj 20 8 tabreceive~ \$0-prev-real;
#X obj 415 648 \$0;
#X obj 21 679 r \$0-window-size;
#X obj 127 622 r \$0-window-size;
#X obj 187 290 r \$0-lock;
#X msg 415 669 \; \$1-window-size 2048 \; \$1-transpo 0 \; \$1-lock
1 \;;
#X connect 0 0 2 1;
#X connect 1 0 2 0;
#X connect 2 0 15 0;
#X connect 2 0 47 0;
#X connect 3 0 5 1;
#X connect 4 0 5 0;
#X connect 5 0 15 1;
#X connect 5 0 46 0;
#X connect 6 0 19 1;
#X connect 7 0 19 0;
#X connect 8 0 10 1;
#X connect 9 0 10 0;
#X connect 10 0 38 0;
#X connect 10 0 37 0;
#X connect 10 0 43 0;
#X connect 11 0 18 1;
#X connect 12 0 16 0;
#X connect 13 0 1 1;
#X connect 13 0 3 1;
#X connect 13 1 0 1;
#X connect 13 1 4 1;
#X connect 14 0 9 1;
#X connect 14 0 7 1;
#X connect 14 1 6 1;
#X connect 14 1 8 1;
#X connect 15 0 24 0;
#X connect 17 0 18 0;
#X connect 18 0 29 0;
#X connect 19 0 39 0;
#X connect 19 0 40 0;
#X connect 19 0 44 0;
#X connect 20 0 1 0;
#X connect 20 0 4 0;
#X connect 21 0 0 0;
#X connect 21 0 3 0;
#X connect 23 0 17 1;
#X connect 23 0 17 0;
#X connect 23 0 20 0;
#X connect 24 0 12 0;
#X connect 25 0 24 1;
#X connect 26 0 12 1;
#X connect 27 0 50 0;
#X connect 28 0 22 0;
#X connect 29 0 20 1;
#X connect 29 0 21 1;
#X connect 30 0 32 1;
#X connect 31 0 32 0;
#X connect 32 0 34 0;
#X connect 33 0 35 1;
#X connect 33 0 36 1;
#X connect 34 0 33 0;
#X connect 35 0 8 0;
#X connect 35 0 7 0;
#X connect 36 0 9 0;
#X connect 36 0 6 0;
#X connect 37 0 41 0;
#X connect 38 0 41 0;
#X connect 39 0 42 0;
#X connect 40 0 42 0;
#X connect 41 0 43 1;
#X connect 42 0 44 1;
#X connect 43 0 23 0;
#X connect 44 0 11 0;
#X connect 44 0 11 1;
#X connect 44 0 21 0;
#X connect 45 0 14 0;
#X connect 45 1 13 0;
#X connect 48 0 30 1;
#X connect 48 0 30 0;
#X connect 48 0 35 0;
#X connect 49 0 31 1;
#X connect 49 0 31 0;
#X connect 49 0 36 0;
#X connect 50 0 54 0;
#X connect 51 0 28 0;
#X connect 52 0 26 0;
#X connect 53 0 41 1;
#X connect 53 0 42 1;
#X restore 294 501 pd fft-analysis;
#N canvas 260 50 667 789 phase-tables 0;
#N canvas 0 50 450 300 (subpatch) 0;
#X array \$0-prev-imag 4096 float 0;
#X coords 0 1000 4096 -1000 400 300 1;
#X restore 169 326 graph;
#N canvas 0 50 450 300 (subpatch) 0;
#X array \$0-prev-real 4096 float 0;
#X coords 0 500 4096 -500 400 300 1;
#X restore 170 17 graph;
#X restore 694 628 pd phase-tables;
#N canvas 0 110 400 363 hann-window 0;
#N canvas 0 50 450 300 (subpatch) 0;
#X array \$0-hann 4096 float 0;
#X coords 0 1 4095 0 300 100 1;
#X restore 36 253 graph;
#X obj 288 130 osc~;
#X obj 288 155 *~ -0.5;
#X obj 288 179 +~ 0.5;
#X obj 241 212 tabwrite~ \$0-hann;
#X obj 26 118 samplerate~;
#X obj 26 142 /;
#X msg 161 71 resize \$1;
#X obj 161 95 s \$0-hann;
#X msg 292 95 0;
#X obj 240 96 t f b;
#X obj 26 67 r \$0-window-size;
#X obj 26 166 s \$0-window-hz;
#X obj 240 70 r \$0-window-hz;
#X obj 26 94 t b f f;
#X text 22 8 calculate Hann window table (variable window size) and
constants window-hz (fundamental frequency of analysis).;
#X connect 1 0 2 0;
#X connect 2 0 3 0;
#X connect 3 0 4 0;
#X connect 5 0 6 0;
#X connect 6 0 12 0;
#X connect 7 0 8 0;
#X connect 9 0 1 1;
#X connect 10 0 1 0;
#X connect 10 1 4 0;
#X connect 10 1 9 0;
#X connect 11 0 14 0;
#X connect 13 0 10 0;
#X connect 14 0 5 0;
#X connect 14 1 6 1;
#X connect 14 2 7 0;
#X restore 694 657 pd hann-window;
#X obj 294 472 delwrite~ \$0-input 1000;
#X obj 294 400 inlet~;
#X obj 296 599 outlet~;
#X obj 626 512 s \$0-transpo;
#X obj 375 400 inlet;
#X obj 657 466 s \$0-window-size;
#X obj 689 381 inlet;
#X obj 555 463 f;
#X obj 606 433 t b f;
#X connect 0 0 5 0;
#X connect 4 0 3 0;
#X connect 7 0 10 0;
#X connect 9 0 11 0;
#X connect 10 0 6 0;
#X connect 11 0 10 0;
#X connect 11 1 8 0;
#X restore -263 170 pd fft-pitchshifter-sub;
#X obj -201 639 outlet~;
#X obj -551 -226 inlet~;
#X obj -194 -234 inlet~;
#X obj -571 -126 hsl 128 15 0 127 0 0 empty empty empty -2 -8 0 10
-262144 -1 -1 9700 1;
#X obj -395 -94 hsl 128 15 0 127 0 0 empty empty empty -2 -8 0 10 -262144
-1 -1 9300 1;
#X obj -458 83 hsl 128 15 0 127 0 0 empty empty empty -2 -8 0 10 -262144
-1 -1 9200 1;
#X obj -436 269 hsl 128 15 0 127 0 0 empty empty empty -2 -8 0 10 -262144
-1 -1 0 1;
#X obj 2 -203 hsl 128 15 0 127 0 0 empty empty empty -2 -8 0 10 -262144
-1 -1 5000 1;
#X obj 26 -103 hsl 128 15 0 127 0 0 empty empty empty -2 -8 0 10 -262144
-1 -1 1200 1;
#X obj 6 25 hsl 128 15 0 127 0 0 empty empty empty -2 -8 0 10 -262144
-1 -1 11700 1;
#X obj -101 199 hsl 128 15 0 127 0 0 empty empty empty -2 -8 0 10 -262144
-1 -1 0 1;
#X obj -549 -151 ctlin 46;
#X obj -369 -159 ctlin 47;
#X obj -343 19 ctlin 48;
#X obj -399 244 ctlin 49;
#X obj 4 -230 ctlin 50;
#X obj 22 -132 ctlin 51;
#X obj 5 -14 ctlin 52;
#X obj -83 170 ctlin 53;
#X obj -103 610 outlet~;
#X connect 0 0 32 2;
#X connect 1 0 33 2;
#X connect 2 0 34 0;
#X connect 3 0 53 0;
#X connect 6 0 32 1;
#X connect 7 0 33 1;
#X connect 8 0 2 1;
#X connect 9 0 3 1;
#X connect 10 0 15 1;
#X connect 11 0 14 1;
#X connect 12 0 7 0;
#X connect 13 0 6 0;
#X connect 14 0 5 0;
#X connect 15 0 4 0;
#X connect 20 0 15 0;
#X connect 20 0 32 0;
#X connect 21 0 14 0;
#X connect 21 0 33 0;
#X connect 22 0 20 0;
#X connect 23 0 22 0;
#X connect 24 0 21 0;
#X connect 25 0 24 0;
#X connect 30 0 0 0;
#X connect 31 0 1 0;
#X connect 32 0 2 0;
#X connect 33 0 3 0;
#X connect 35 0 4 0;
#X connect 36 0 5 0;
#X connect 37 0 10 0;
#X connect 38 0 23 0;
#X connect 39 0 13 0;
#X connect 40 0 8 0;
#X connect 41 0 11 0;
#X connect 42 0 25 0;
#X connect 43 0 12 0;
#X connect 44 0 9 0;
#X connect 45 0 37 0;
#X connect 46 0 38 0;
#X connect 47 0 39 0;
#X connect 48 0 40 0;
#X connect 49 0 41 0;
#X connect 50 0 42 0;
#X connect 51 0 43 0;
#X connect 52 0 44 0;
#X restore 481 586 pd chorusing;
#X obj 432 380 s volume_main;
#X obj 278 622 r volume_main;
#X obj 2 234 s bang_start;
#X obj 1 258 r bang_start;
#X obj -176 132 r bang_start;
#X obj 347 377 s transpo;
#X connect 1 0 0 0;
#X connect 1 0 0 1;
#X connect 2 0 46 0;
#X connect 3 0 5 0;
#X connect 4 0 6 1;
#X connect 5 0 4 0;
#X connect 6 0 23 0;
#X connect 7 0 6 0;
#X connect 8 0 3 0;
#X connect 9 0 10 0;
#X connect 11 0 12 0;
#X connect 14 0 15 0;
#X connect 17 0 1 0;
#X connect 17 0 45 0;
#X connect 17 0 45 1;
#X connect 20 0 19 0;
#X connect 22 0 48 0;
#X connect 23 0 16 0;
#X connect 25 0 51 0;
#X connect 27 0 36 0;
#X connect 28 0 31 0;
#X connect 28 1 38 0;
#X connect 29 0 37 0;
#X connect 29 0 39 0;
#X connect 30 0 44 0;
#X connect 31 0 33 0;
#X connect 31 1 32 0;
#X connect 32 0 33 1;
#X connect 33 0 34 0;
#X connect 34 0 29 0;
#X connect 35 0 38 0;
#X connect 36 0 28 0;
#X connect 36 1 35 0;
#X connect 39 0 40 0;
#X connect 40 0 41 0;
#X connect 42 0 39 1;
#X connect 43 0 13 0;
#X connect 45 0 0 0;
#X connect 45 1 0 1;
#X connect 47 0 1 1;
#X connect 49 0 8 0;
#X connect 50 0 44 0;
#X coords 0 -1 1 1 400 270 1 100 100;
